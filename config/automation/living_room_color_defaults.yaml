######################################################################
# Living room color defaults: cool white by day, amber by evening.
# Restores after entry/garage secure and when lights are turned on.
######################################################################

- alias: 'Living Room Defaults on Turn-On'
  id: living_room_defaults_on_turn_on
  mode: single
  trigger:
    - platform: state
      entity_id:
        - light.living_room_lights
      from: 'off'
      to: 'on'
  condition:
    - condition: state
      entity_id: group.entry_points
      state: 'off'
    - condition: state
      entity_id: group.garage_doors
      state: 'closed'
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: sun.sun
              state: 'above_horizon'
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_lights
              data:
                kelvin: 5500
                brightness: 255
      default:
        - service: light.turn_on
          target:
            entity_id: light.living_room_lights
          data:
            kelvin: 2700
            brightness: 200

- alias: 'Restore Living Room After Entry Secured'
  id: restore_living_room_after_entry_secured
  mode: single
  trigger:
    - platform: state
      entity_id: group.entry_points
      to: 'off'
    - platform: state
      entity_id: group.garage_doors
      to: 'closed'
  condition:
    - condition: state
      entity_id: group.entry_points
      state: 'off'
    - condition: state
      entity_id: group.garage_doors
      state: 'closed'
  action:
    - choose:
        - conditions:
            - condition: state
              entity_id: sun.sun
              state: 'above_horizon'
          sequence:
            - service: light.turn_on
              target:
                entity_id: light.living_room_lights
              data:
                kelvin: 5500
                brightness: 255
      default:
        - service: light.turn_on
          target:
            entity_id: light.living_room_lights
          data:
            kelvin: 2700
            brightness: 200
