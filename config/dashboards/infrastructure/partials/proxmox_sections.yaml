######################################################################
# @CCOSTAN - Follow Me on X
# For more info visit https://www.vcloudinfo.com/click-here
# Original Repo : https://github.com/CCOSTAN/Home-AssistantConfig
# -------------------------------------------------------------------
# Infrastructure Partial - proxmox sections
#  Reusable list extracted from a view for smaller diffs and safer edits.
# -------------------------------------------------------------------
# Notes: Standardized on `custom:button-card` + `custom:mini-graph-card` with `card_mod` polish.
######################################################################

- !include /config/dashboards/infrastructure/partials/infra_top_chips_section.yaml

- type: grid
  column_span: 4
  columns: 4
  square: false
  cards:
  - type: custom:button-card
    template: bearstone_infra_kpi
    entity: sensor.node_proxmox1_cpu_used
    name: P1 CPU
    icon: mdi:cpu-64-bit
  - type: custom:button-card
    template: bearstone_infra_kpi
    entity: sensor.node_proxmox1_memory_used_percentage
    name: P1 MEM
    icon: mdi:memory
  - type: custom:button-card
    template: bearstone_infra_kpi
    entity: sensor.node_proxmox02_cpu_used
    name: P2 CPU
    icon: mdi:cpu-64-bit
  - type: custom:button-card
    template: bearstone_infra_kpi
    entity: sensor.node_proxmox02_memory_used_percentage
    name: P2 MEM
    icon: mdi:memory

- type: grid
  column_span: 4
  columns: 3
  square: false
  cards:
  - type: custom:vertical-stack-in-card
    card_mod:
      style: !include /config/dashboards/infrastructure/card_mod/infra_panel.yaml
    cards:
    - type: custom:button-card
      template: bearstone_infra_panel_header
      name: Proxmox01
    - type: custom:mini-graph-card
      name: Host CPU / Memory
      icon: mdi:server
      hours_to_show: 24
      points_per_hour: 2
      line_width: 2
      animate: true
      show:
        fill: true
        legend: false
        icon: true
        name: true
        state: true
      entities:
      - entity: sensor.node_proxmox1_cpu_used
        name: CPU
      - entity: sensor.node_proxmox1_memory_used_percentage
        name: Memory
    - type: custom:mini-graph-card
      name: VMs CPU / Memory
      icon: mdi:chart-line
      hours_to_show: 24
      points_per_hour: 2
      line_width: 2
      animate: true
      show:
        fill: false
        legend: false
        icon: true
        name: true
        state: false
      entities:
      - entity: sensor.qemu_docker69_169_cpu_used
        name: Docker69 CPU
      - entity: sensor.qemu_docker69_169_memory_used_percentage
        name: Docker69 MEM
      - entity: sensor.qemu_carlo_hass_105_cpu_used
        name: HASS CPU
      - entity: sensor.qemu_carlo_hass_105_memory_used_percentage
        name: HASS MEM
      - entity: sensor.qemu_wireguard_104_cpu_used
        name: WireGuard CPU
      - entity: sensor.qemu_wireguard_104_memory_used_percentage
        name: WireGuard MEM

  - type: custom:vertical-stack-in-card
    card_mod:
      style: !include /config/dashboards/infrastructure/card_mod/infra_panel.yaml
    cards:
    - type: custom:button-card
      template: bearstone_infra_panel_header
      name: Proxmox02
    - type: custom:mini-graph-card
      name: Host CPU / Memory
      icon: mdi:server
      hours_to_show: 24
      points_per_hour: 2
      line_width: 2
      animate: true
      show:
        fill: true
        legend: false
        icon: true
        name: true
        state: true
      entities:
      - entity: sensor.node_proxmox02_cpu_used
        name: CPU
      - entity: sensor.node_proxmox02_memory_used_percentage
        name: Memory
    - type: custom:mini-graph-card
      name: Frigate VM CPU / Memory
      icon: mdi:video
      hours_to_show: 24
      points_per_hour: 2
      line_width: 2
      animate: true
      show:
        fill: false
        legend: false
        icon: true
        name: true
        state: false
      entities:
      - entity: sensor.qemu_docker2_101_cpu_used
        name: CPU
      - entity: sensor.qemu_docker2_101_memory_used_percentage
        name: MEM

  - type: custom:vertical-stack-in-card
    card_mod:
      style: !include /config/dashboards/infrastructure/card_mod/infra_panel.yaml
    cards:
    - type: custom:button-card
      template: bearstone_infra_panel_header
      name: Garage Temp
    - type: custom:mini-graph-card
      entities:
      - entity: sensor.proxmox_garage_average_temperature
        name: Garage
      - entity: sensor.pirateweather_temperature
        name: Outside
      name: Garage Temp
      hours_to_show: 96
      color_thresholds:
      - value: 50
        color: '#f39c12'
      - value: 120
        color: '#d35400'
      - value: 145
        color: '#c0392b'
      card_mod:
        style: !include /config/dashboards/infrastructure/card_mod/infra_card.yaml
